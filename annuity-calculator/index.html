<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Annuity Calculator | CalcWorld</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f5f7fb;
}
header{
  background:#fff;
  padding:14px 24px;
  box-shadow:0 2px 6px rgba(0,0,0,.06);
}
header a{
  text-decoration:none;
  font-weight:bold;
  color:#2563eb;
  font-size:20px;
}
.container{
  max-width:420px;
  margin:40px auto;
}
.card{
  background:#fff;
  padding:26px;
  border-radius:14px;
  box-shadow:0 12px 30px rgba(0,0,0,.08);
}
h1{
  text-align:center;
  margin-top:0;
}
label{
  font-weight:bold;
  display:block;
  margin-top:18px;
}
.value{
  float:right;
  color:#059669;
}
input[type=text], select{
  width:100%;
  padding:10px;
  margin-top:6px;
  font-size:16px;
}
input[type=range]{
  width:100%;
}
.radio{
  margin-top:14px;
}
.result{
  background:#f8fafc;
  padding:16px;
  border-radius:10px;
  margin-top:20px;
  text-align:center;
}
.result h2{
  margin:0;
}
.small{
  font-size:13px;
  color:#555;
}
ul{
  padding-left:18px;
  font-size:13px;
}
footer{
  text-align:center;
  margin-top:14px;
}
footer a{
  color:#2563eb;
  font-size:14px;
}
</style>
</head>

<body>

<header>
  <a href="/">CalcWorld</a>
</header>

<div class="container">
<div class="card">

<h1>Annuity Calculator</h1>

<label>
Investment Amount (₹)
<span class="value" id="invLabel"></span>
</label>
<input type="text" id="investment" value="1,00,000">
<input type="range" id="invRange" min="100000" max="100000000" step="1000" value="100000">

<label>
Annuity Rate (% p.a.)
<span class="value" id="rateLabel"></span>
</label>
<input type="range" id="rate" min="4" max="10" step="0.25" value="6.75">

<label>Payout Frequency</label>
<select id="frequency">
  <option value="12">Monthly</option>
  <option value="4">Quarterly</option>
  <option value="1">Yearly</option>
</select>

<label>
Payout Duration (Years)
<span class="value" id="yearsLabel"></span>
</label>
<input type="range" id="years" min="1" max="30" value="10">

<div class="radio">
  <label>
    <input type="radio" name="mode" value="drawdown" checked>
    Income with capital drawdown
  </label>
</div>

<div class="radio">
  <label>
    <input type="radio" name="mode" value="fixed">
    Fixed income (capital preserved)
  </label>
</div>

<div class="result">
  <h2 id="payout">₹0</h2>
  <div class="small">Income per payout</div>
  <hr>
  <div id="total"></div>
  <div class="small">Payouts start after first payout period</div>
</div>

<ul>
  <li>Drawdown option exhausts corpus</li>
  <li>Fixed income pays interest only</li>
  <li>No compounding between payouts</li>
  <li>Income taxable as per slab</li>
</ul>



</div>
</div>

<script>
const investmentInput = document.getElementById("investment");
const invRange = document.getElementById("invRange");
const rate = document.getElementById("rate");
const frequency = document.getElementById("frequency");
const years = document.getElementById("years");
const modeRadios = document.querySelectorAll("input[name=mode]");

const payoutEl = document.getElementById("payout");
const totalEl = document.getElementById("total");
const invLabel = document.getElementById("invLabel");
const rateLabel = document.getElementById("rateLabel");
const yearsLabel = document.getElementById("yearsLabel");

const MIN_INVEST = 100000;
const MAX_INVEST = 100000000; // ₹10 Cr

/* ---------- helpers ---------- */
function formatINR(num){
  return "₹" + Math.round(num).toLocaleString("en-IN");
}
function cleanNumber(val){
  return Number(val.replace(/[^\d]/g,"")) || 0;
}
function clamp(v,min,max){
  return Math.min(Math.max(v,min),max);
}

/* ---------- INPUT HANDLING (FIX) ---------- */

// While typing → NO formatting
investmentInput.addEventListener("input", () => {
  let raw = cleanNumber(investmentInput.value);
  if(raw > MAX_INVEST) raw = MAX_INVEST;
  invRange.value = raw || MIN_INVEST;
  calculate();
});

// On blur → format nicely
investmentInput.addEventListener("blur", () => {
  let val = clamp(cleanNumber(investmentInput.value), MIN_INVEST, MAX_INVEST);
  investmentInput.value = val.toLocaleString("en-IN");
  invRange.value = val;
  calculate();
});

// Slider → always formatted
invRange.addEventListener("input", () => {
  investmentInput.value = Number(invRange.value).toLocaleString("en-IN");
  calculate();
});

[rate, frequency, years].forEach(el => el.addEventListener("input", calculate));
modeRadios.forEach(r => r.addEventListener("change", calculate));

/* ---------- CALCULATION ---------- */
function calculate(){
  let P = clamp(cleanNumber(investmentInput.value), MIN_INVEST, MAX_INVEST);
  let r = rate.value / 100;
  let n = Number(frequency.value);
  let y = Number(years.value);
  let periods = n * y;

  invLabel.textContent = formatINR(P);
  rateLabel.textContent = rate.value + "%";
  yearsLabel.textContent = y + " years";

  let payout = 0;
  let total = 0;

  const mode = document.querySelector("input[name=mode]:checked").value;

  if(mode === "fixed"){
    // Interest only
    payout = (P * r) / n;
    total = payout * periods;
  } else {
    // Capital drawdown (true annuity)
    let pr = r / n;
    payout = P * (pr * Math.pow(1 + pr, periods)) / (Math.pow(1 + pr, periods) - 1);
    total = payout * periods;
  }

  payoutEl.textContent = formatINR(payout);
  totalEl.innerHTML = `Total Income Received: <b>${formatINR(total)}</b>`;
}

calculate();
</script>


</body>
</html>
