<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Reality-Check Trading Calculator | CalcWorld</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial,sans-serif;background:#f6f7fb;margin:0}
header{background:#fff;padding:14px 24px;box-shadow:0 2px 4px rgba(0,0,0,.05)}
header a{text-decoration:none;color:#2563eb;font-size:20px;font-weight:bold}
.container{max-width:600px;margin:30px auto;background:#fff;padding:22px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
h1{font-size:22px;margin-bottom:8px}
label{display:block;margin-top:16px;font-size:14px}
input,select{width:100%;padding:10px;font-size:15px;margin-top:6px;border:1px solid #ccc;border-radius:8px}
input[type=range]{padding:0}
button{width:100%;padding:12px;margin-top:22px;font-size:16px;border:none;border-radius:10px;background:#2563eb;color:#fff;cursor:pointer}
.result{margin-top:22px;background:#f1f5ff;padding:16px;border-radius:10px;display:none}
.green{color:#059669;font-weight:bold}
.red{color:#dc2626;font-weight:bold}
.small{font-size:12px;color:#555;margin-top:14px}
</style>
</head>

<body>

<header><a href="/">CalcWorld</a></header>

<div class="container">
<h1>Reality-Check Trading Calculator</h1>
<p style="font-size:13px;color:#555">
Deterministic brokerage-aware compounding under SEBI peak-margin regime.
</p>

<label>Starting Capital (₹)</label>
<input id="capital" type="text" value="₹10,00,000">
<input id="capRange" type="range" min="10000" max="10000000" step="10000" value="1000000">

<label>Trading Segment</label>
<select id="segment">
  <option value="FO">F&O – Intraday</option>
  <option value="EQI">Equity – Intraday</option>
</select>

<label>Trade Frequency</label>
<select id="frequency">
  <option value="250">Daily (250 trades)</option>
  <option value="48">Weekly (48 trades)</option>
  <option value="12">Monthly (12 trades)</option>
</select>

<label>Average Profit per Trade (%)</label>
<input id="pPct" type="number" min="0" max="20" step="0.01" value="0.19">
<input id="pRange" type="range" min="0" max="20" step="0.01" value="0.19">

<label>Average Loss per Trade (%)</label>
<input id="lPct" type="number" min="0" max="20" step="0.01" value="1">
<input id="lRange" type="range" min="0" max="20" step="0.01" value="1">

<label>Win Rate (%)</label>
<input id="winRate" type="number" min="0" max="100" step="1" value="100">
<input id="winRange" type="range" min="0" max="100" step="1" value="100">

<label style="margin-top:12px"><input type="checkbox" id="includeCharges" checked>
Include brokerage & statutory charges</label>

<label><input type="checkbox" id="compound" checked>
Apply compounding</label>

<button onclick="runCalc()">Run Reality Check</button>

<div class="result" id="output">
  <p><strong>Final Capital:</strong> <span id="final"></span></p>
  <p><strong>Net Profit:</strong> <span id="profit"></span></p>
  <p><strong>Total Charges Paid:</strong> <span id="fees"></span></p>
  <p><strong>Verdict:</strong> <span id="verdict"></span></p>
</div>

<p class="small">
<strong>Disclaimer:</strong> This calculator is for educational purposes only.
Trading involves risk. Past performance does not guarantee future results.
This tool is not SEBI certified or endorsed.
</p>

</div>

<script>
function formatINR(n){return "₹"+Math.round(n).toLocaleString("en-IN");}
function parseINR(s){return parseFloat(s.replace(/[^0-9.]/g,""))||0;}

const cap=document.getElementById("capital");
const capRange=document.getElementById("capRange");

// Sync INR formatting
capRange.oninput=()=>cap.value=formatINR(capRange.value);
cap.onblur=()=>{let v=parseINR(cap.value);v=Math.min(10000000,Math.max(10000,v));cap.value=formatINR(v);capRange.value=v};

// Slider sync
["pPct","pRange"].forEach(id=>{
 document.getElementById(id).oninput=()=>pPct.value=pRange.value=pPct.value;
});
["lPct","lRange"].forEach(id=>{
 document.getElementById(id).oninput=()=>lPct.value=lRange.value=lPct.value;
});
["winRate","winRange"].forEach(id=>{
 document.getElementById(id).oninput=()=>winRate.value=winRange.value=winRate.value;
});

// Brokerage calc
function calcCharges(turnover,pnl,segment){
  const BR=40;
  let stt=0,exch=0,sebi=0,gst=0,stamp=0;

  if(segment==="FO"){
    stt = pnl>0 ? pnl*0.001 : 0;
    exch = turnover*0.0000173;
  }else{
    stt = pnl>0 ? pnl*0.00025 : 0.0025;
    exch = turnover*0.0000297;
  }
  sebi = turnover*0.000001;
  let raw = BR + stt + exch + sebi;
  gst = raw*0.18;
  stamp = turnover*0.00003;
  return BR+stt+exch+sebi+gst+stamp;
}

function runCalc(){
  let capital=parseINR(cap.value);
  const trades=parseInt(frequency.value);
  const p=parseFloat(pPct.value)/100;
  const l=parseFloat(lPct.value)/100;
  const w=parseFloat(winRate.value)/100;
  const seg=segment.value;
  const include=includeCharges.checked;
  const compound=compound.checked;
  const start=capital;
  let fees=0,balance=capital;

  // Deterministic W/L order: W repeated first, then L if needed
  const wins=Math.round(trades*w);
  const losses=trades-wins;
  const outcomes=[...Array(wins).fill(true),...Array(losses).fill(false)];

  outcomes.forEach(win=>{
    const rate=win?p:-l;
    const pnl=balance*rate;
    const turnover=Math.abs(pnl)*100;
    const fee=include?calcCharges(turnover,pnl,seg):0;
    fees+=fee;
    balance+=pnl-fee;
    if(!compound) balance=start-(fees)+((wins-losses)*start*rate);
  });

  document.getElementById("final").innerText=formatINR(balance);
  document.getElementById("profit").innerText=formatINR(balance-start);
  document.getElementById("fees").innerText=formatINR(fees);
  document.getElementById("verdict").innerText=(balance-start>=0?"Positive":"Negative")+" Expectancy";

  output.style.display="block";
}
</script>

</body>
</html>
