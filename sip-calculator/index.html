<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SIP & Lumpsum Calculator | CalcWorld</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial,sans-serif;background:#f6f7f9;margin:0}
header{background:#fff;padding:16px 20px;box-shadow:0 2px 4px rgba(0,0,0,.05)}
main{max-width:420px;margin:30px auto;padding:0 16px}
.card{background:#fff;padding:20px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.08)}

.tabs{display:flex;background:#eef2f7;border-radius:30px;padding:4px;margin-bottom:20px}
.tab{flex:1;text-align:center;padding:10px;border-radius:30px;font-weight:bold;cursor:pointer}
.tab.active{background:#2563eb;color:#fff}

.field{margin-bottom:18px}
.label{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:6px}

.input-box{
  display:flex;align-items:center;gap:4px;
  background:#eafff6;padding:6px 8px;border-radius:6px
}
.input-box input{
  border:none;background:transparent;width:100px;
  text-align:right;font-weight:bold;outline:none
}

input[type=range]{width:100%}
.error{color:#dc2626;font-size:12px;margin-top:4px;display:none}

.advanced{
  margin-top:15px;
  padding:12px;
  background:#f1f5f9;
  border-radius:12px
}

.results{margin-top:20px}
.result{display:flex;justify-content:space-between;margin-bottom:10px;font-weight:bold}

canvas{max-width:220px;margin:20px auto 0;display:block}
</style>
</head>

<body>
<header><h2 style="margin:0">CalcWorld</h2></header>

<main>
<div class="card">

<div class="tabs">
  <div class="tab active" id="sipTab">SIP</div>
  <div class="tab" id="lumpTab">Lumpsum</div>
</div>

<!-- Amount -->
<div class="field">
  <div class="label describes">
    <span id="amountLabel">Monthly Investment</span>
    <div class="input-box">₹ <input id="amountInput"></div>
  </div>
  <input type="range" id="amountRange">
  <div class="error" id="amountError"></div>
</div>

<!-- Return -->
<div class="field">
  <div class="label">
    <span>Expected Return</span>
    <div class="input-box"><input id="returnInput"> %</div>
  </div>
  <input type="range" id="returnRange">
  <div class="error" id="returnError"></div>
</div>

<!-- Years -->
<div class="field">
  <div class="label">
    <span>Time Period</span>
    <div class="input-box"><input id="yearInput"> Yr</div>
  </div>
  <input type="range" id="yearRange">
  <div class="error" id="yearError"></div>
</div>

<!-- ADVANCED -->
<div class="advanced" id="advancedBox">
  <b>Advanced</b><br><br>

  <div id="sipAdvance">
    Increase SIP by
    <input id="sipIncValue" style="width:60px"> 
    <select id="sipIncType">
      <option value="rupee">₹</option>
      <option value="percent">%</option>
    </select>
    every
    <select id="sipIncInterval">
      <option value="6">6 Months</option>
      <option value="12">1 Year</option>
    </select>
  </div>

  <div id="lumpAdvance" style="display:none">
    Reinvest same amount every
    <select id="lumpInterval">
      <option value="6">6 Months</option>
      <option value="12">1 Year</option>
    </select>
  </div>
</div>

<div class="results">
  <div class="result"><span>Total Invested</span><span id="invested">₹0</span></div>
  <div class="result"><span>Estimated Returns</span><span id="returns">₹0</span></div>
  <div class="result"><span>Maturity Value</span><span id="maturity">₹0</span></div>
</div>

<canvas id="donutChart"></canvas>

</div>
</main>

<script>
let mode="sip";

const LIMITS={
  sip:{min:100,max:1000000},
  lump:{min:100,max:10000000},
  rate:{min:1,max:40},
  years:{min:1,max:50},
  sipIncR:{max:100000},
  sipIncP:{max:100}
};

const $=id=>document.getElementById(id);

const chart=new Chart(donutChart,{
  type:"doughnut",
  data:{labels:["Returns","Invested"],datasets:[{data:[0,0],backgroundColor:["#facc15","#2563eb"]}]},
  options:{plugins:{legend:{position:"bottom"}}}
});

function format(n){
  return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(n);
}

function error(el,msg){
  el.textContent=msg;
  el.style.display=msg?"block":"none";
}

function calculate(){
  let A=+$("amountInput").value.replace(/\D/g,"");
  let r=+$("returnInput").value/100;
  let y=+$("yearInput").value;

  const lim=mode==="sip"?LIMITS.sip:LIMITS.lump;
  if(A<lim.min||A>lim.max){error(amountError,`Allowed ₹${lim.min} – ₹${lim.max}`);return}
  if(r*100<LIMITS.rate.min||r*100>LIMITS.rate.max){error(returnError,"Invalid return");return}
  if(y<LIMITS.years.min||y>LIMITS.years.max){error(yearError,"Invalid years");return}

  error(amountError,"");error(returnError,"");error(yearError,"");

  let invested=0,maturity=0;
  const rm=r/12,n=y*12;

  if(mode==="sip"){
    let sip=A;
    const inc=+$("sipIncValue").value||0;
    const int=+$("sipIncInterval").value;
    for(let m=1;m<=n;m++){
      if(m>int && (m-1)%int===0){
        sip+= $("sipIncType").value==="rupee"?inc:sip*(inc/100);
      }
      invested+=sip;
      maturity+=sip*Math.pow(1+rm,n-m+1);
    }
  }else{
    invested=A;
    maturity=A*Math.pow(1+r,y);
    const int=+$("lumpInterval").value;
    for(let m=int;m<=n;m+=int){
      invested+=A;
      maturity+=A*Math.pow(1+rm,n-m+1);
    }
  }

  investedEl.textContent=format(invested);
  returnsEl.textContent=format(maturity-invested);
  maturityEl.textContent=format(maturity);
  chart.data.datasets[0].data=[maturity-invested,invested];
  chart.update();
}

sipTab.onclick=()=>{
  mode="sip";
  sipTab.classList.add("active");
  lumpTab.classList.remove("active");
  sipAdvance.style.display="block";
  lumpAdvance.style.display="none";
  amountLabel.textContent="Monthly Investment";
  calculate();
};

lumpTab.onclick=()=>{
  mode="lump";
  lumpTab.classList.add("active");
  sipTab.classList.remove("active");
  sipAdvance.style.display="none";
  lumpAdvance.style.display="block";
  amountLabel.textContent="Investment Amount";
  calculate();
};

document.querySelectorAll("input,select").forEach(e=>e.oninput=calculate);

amountInput.value="10000";
returnInput.value="12";
yearInput.value="10";
calculate();
</script>
</body>
</html>
