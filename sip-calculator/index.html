<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SIP & Lumpsum Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f5f7fb}
.card{max-width:420px;margin:40px auto;background:#fff;padding:20px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.1)}
.tabs{display:flex;background:#eef2f7;border-radius:30px;padding:4px}
.tab{flex:1;text-align:center;padding:10px;border-radius:30px;font-weight:bold;cursor:pointer}
.tab.active{background:#2563eb;color:#fff}

.field{margin-top:18px}
.label{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:6px}
.value{background:#eafff6;padding:6px 10px;border-radius:6px}
.value input{border:none;background:transparent;width:90px;text-align:right;font-weight:bold}

input[type=range]{width:100%}

.advanced-toggle{margin:16px 0;font-weight:bold}
.advanced{display:none;background:#f1f5f9;padding:12px;border-radius:12px}

.results{margin-top:16px}
.row{display:flex;justify-content:space-between;margin-bottom:6px;font-weight:bold}

table{width:100%;margin-top:16px;border-collapse:collapse;font-size:14px;display:none}
td,th{padding:6px;text-align:right}
th:first-child,td:first-child{text-align:left}

canvas{max-width:220px;margin:20px auto 0;display:block}
</style>
</head>

<body>

<div class="card">

<div class="tabs">
  <div class="tab active" id="sipTab">SIP</div>
  <div class="tab" id="lumpTab">Lumpsum</div>
</div>

<div class="field">
  <div class="label">
    <span id="amountLabel">Monthly Investment</span>
    <div class="value">₹ <input id="amountInput"></div>
  </div>
  <input type="range" id="amountRange">
</div>

<div class="field">
  <div class="label">
    <span>Expected Return</span>
    <div class="value"><input id="returnInput"> %</div>
  </div>
  <input type="range" id="returnRange" min="1" max="40" step="0.1">
</div>

<div class="field">
  <div class="label">
    <span>Time Period</span>
    <div class="value"><input id="yearInput"> Yr</div>
  </div>
  <input type="range" id="yearRange" min="1" max="50">
</div>

<div class="advanced-toggle">
  <label><input type="checkbox" id="advToggle"> Enable Advanced</label>
</div>

<div class="advanced" id="advancedBox">
  Increase SIP by
  <input id="advValue" value="0" style="width:70px">
  <select id="advType">
    <option value="rupee">₹</option>
    <option value="percent">%</option>
  </select>
  every
  <select id="advFreq">
    <option value="12">1 Year</option>
    <option value="6">6 Months</option>
  </select>
</div>

<div class="results" id="normalResults">
  <div class="row"><span>Total Invested</span><span id="nInv">₹0</span></div>
  <div class="row"><span>Estimated Returns</span><span id="nRet">₹0</span></div>
  <div class="row"><span>Maturity Value</span><span id="nMat">₹0</span></div>
</div>

<table id="compareTable">
<tr><th></th><th>Normal</th><th>Advanced</th><th>Difference</th></tr>
<tr><th>Invested</th><td id="cInvN">₹0</td><td id="cInvA">₹0</td><td id="cInvD">₹0</td></tr>
<tr><th>Returns</th><td id="cRetN">₹0</td><td id="cRetA">₹0</td><td id="cRetD">₹0</td></tr>
<tr><th>Maturity</th><td id="cMatN">₹0</td><td id="cMatA">₹0</td><td id="cMatD">₹0</td></tr>
</table>

<canvas id="chart"></canvas>

</div>

<script>
let mode="sip";

const fmt=n=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(Math.round(n));

const chart=new Chart(chart,{
  type:"doughnut",
  data:{labels:["Returns","Invested"],datasets:[{data:[0,0],backgroundColor:["#facc15","#2563eb"]}]},
  options:{plugins:{legend:{position:"bottom"}}}
});

function clamp(v,min,max){return Math.min(Math.max(v,min),max)}

function sync(range,input,min,max){
  let v=parseFloat(input.value);
  if(isNaN(v)) v=min;
  v=clamp(v,min,max);
  input.value=v;
  range.value=v;
  return v;
}

function calc(){
  const A=sync(amountRange,amountInput,100,mode==="sip"?1000000:10000000);
  const r=sync(returnRange,returnInput,1,40)/100;
  const y=sync(yearRange,yearInput,1,50);

  let nInv,nMat;

  if(mode==="sip"){
    const rm=r/12,n=y*12;
    nInv=A*n;
    nMat=A*((Math.pow(1+rm,n)-1)/rm)*(1+rm);
  }else{
    nInv=A;
    nMat=A*Math.pow(1+r,y);
  }

  nInvSpan=nInv;
  nMatSpan=nMat;

  nInvEl.textContent=fmt(nInv);
  nMatEl.textContent=fmt(nMat);
  nRetEl.textContent=fmt(nMat-nInv);

  let aInv=nInv,aMat=nMat;

  if(advToggle.checked && mode==="sip"){
    let sip=A;
    aInv=0;aMat=0;
    const inc=advType.value==="rupee"?Math.min(+advValue.value,100000):Math.min(+advValue.value,100);
    for(let m=1;m<=y*12;m++){
      if(m>advFreq.value && (m-1)%advFreq.value===0){
        sip+=advType.value==="rupee"?inc:sip*(inc/100);
      }
      aInv+=sip;
      aMat+=sip*Math.pow(1+r/12,y*12-m+1);
    }
  }

  if(advToggle.checked){
    compareTable.style.display="table";
    normalResults.style.display="none";

    cInvN.textContent=fmt(nInv);
    cInvA.textContent=fmt(aInv);
    cInvD.textContent=fmt(aInv-nInv);

    cRetN.textContent=fmt(nMat-nInv);
    cRetA.textContent=fmt(aMat-aInv);
    cRetD.textContent=fmt((aMat-aInv)-(nMat-nInv));

    cMatN.textContent=fmt(nMat);
    cMatA.textContent=fmt(aMat);
    cMatD.textContent=fmt(aMat-nMat);
  }else{
    compareTable.style.display="none";
    normalResults.style.display="block";
  }

  chart.data.datasets[0].data=[(advToggle.checked?aMat:nMat)-(advToggle.checked?aInv:nInv),(advToggle.checked?aInv:nInv)];
  chart.update();
}

/* EVENTS */
amountInput.oninput=calc;
amountRange.oninput=()=>{amountInput.value=amountRange.value;calc();}
returnInput.oninput=calc;
returnRange.oninput=()=>{returnInput.value=returnRange.value;calc();}
yearInput.oninput=calc;
yearRange.oninput=()=>{yearInput.value=yearRange.value;calc();}
advToggle.onchange=()=>{advancedBox.style.display=advToggle.checked?"block":"none";calc();}

sipTab.onclick=()=>{
  mode="sip";
  sipTab.classList.add("active");
  lumpTab.classList.remove("active");
  amountLabel.textContent="Monthly Investment";
  calc();
};
lumpTab.onclick=()=>{
  mode="lump";
  lumpTab.classList.add("active");
  sipTab.classList.remove("active");
  amountLabel.textContent="Investment Amount";
  advToggle.checked=false;
  advancedBox.style.display="none";
  calc();
};

/* INIT */
amountInput.value=10000;
returnInput.value=12;
yearInput.value=10;
amountRange.value=10000;
returnRange.value=12;
yearRange.value=10;
calc();
</script>

</body>
</html>
