<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SIP & Lumpsum Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:Arial,sans-serif;background:#f6f7f9;margin:0}
main{max-width:420px;margin:30px auto;padding:16px}
.card{background:#fff;padding:20px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,.08)}
.tabs{display:flex;background:#eef2f7;border-radius:30px;padding:4px;margin-bottom:20px}
.tab{flex:1;text-align:center;padding:10px;border-radius:30px;font-weight:bold;cursor:pointer}
.tab.active{background:#2563eb;color:#fff}
.field{margin-bottom:18px}
.label{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:6px}
.input-box{background:#eafff6;padding:6px 8px;border-radius:6px}
.input-box input{border:none;background:transparent;width:120px;text-align:right;font-weight:bold}
input[type=range]{width:100%}
.advanced{display:none;background:#f9fafb;padding:12px;border-radius:10px}
.error{color:#dc2626;font-size:12px}
.result{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:6px}
canvas{max-width:220px;margin:20px auto 0;display:block}
</style>
</head>

<body>
<main>
<div class="card">

<div class="tabs">
  <div class="tab active" id="sipTab">SIP</div>
  <div class="tab" id="lumpTab">Lumpsum</div>
</div>

<div class="field">
  <div class="label">
    <span id="amountLabel">Monthly Investment</span>
    <div class="input-box">₹ <input id="amountInput"></div>
  </div>
  <input type="range" id="amountRange">
  <div class="error" id="amountErr"></div>
</div>

<div class="field">
  <label><input type="checkbox" id="sipStepToggle"> Increase SIP over time</label>
</div>

<div class="advanced" id="sipAdvanced">
  <div class="field">
    <label>Increase Type</label>
    <select id="sipStepType">
      <option value="fixed">Fixed (₹)</option>
      <option value="percent">Percentage (%)</option>
    </select>
  </div>
  <div class="field">
    <label>Increase Value</label>
    <input id="sipStepValue">
  </div>
  <div class="field">
    <label>Interval</label>
    <select id="sipStepInterval">
      <option value="12">Every Year</option>
      <option value="6">Every 6 Months</option>
    </select>
  </div>
</div>

<div class="field">
  <div class="label">
    <span>Expected Return</span>
    <div class="input-box"><input id="returnInput"> %</div>
  </div>
  <input type="range" id="returnRange">
</div>

<div class="field">
  <div class="label">
    <span>Time Period</span>
    <div class="input-box"><input id="yearInput"> Yr</div>
  </div>
  <input type="range" id="yearRange">
</div>

<div class="result"><span>Total Invested</span><span id="invested"></span></div>
<div class="result"><span>Estimated Returns</span><span id="returns"></span></div>
<div class="result"><span>Maturity Value</span><span id="maturity"></span></div>

<canvas id="chart"></canvas>

</div>
</main>

<script>
/* ---------- CONSTANTS ---------- */
const LIMITS = {
  sip:[1,1_000_000],
  lump:[1,10_000_000],
  rate:[1,40],
  years:[1,50]
};

let mode="sip";

/* ---------- ELEMENTS ---------- */
const amountInput = document.getElementById("amountInput");
const amountRange = document.getElementById("amountRange");
const returnInput = document.getElementById("returnInput");
const returnRange = document.getElementById("returnRange");
const yearInput = document.getElementById("yearInput");
const yearRange = document.getElementById("yearRange");
const invested = document.getElementById("invested");
const returns = document.getElementById("returns");
const maturity = document.getElementById("maturity");
const sipStepToggle = document.getElementById("sipStepToggle");
const sipAdvanced = document.getElementById("sipAdvanced");
const sipStepType = document.getElementById("sipStepType");
const sipStepValue = document.getElementById("sipStepValue");
const sipStepInterval = document.getElementById("sipStepInterval");

/* ---------- HELPERS ---------- */
const ₹ = n => new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(Math.round(n));
const num = v => Number(String(v).replace(/[^0-9.]/g,""))||0;
const clamp = (v,min,max)=>Math.min(Math.max(v,min),max);

/* ---------- CHART ---------- */
const chart=new Chart(document.getElementById("chart"),{
  type:"doughnut",
  data:{labels:["Returns","Invested"],datasets:[{data:[0,0],backgroundColor:["#facc15","#2563eb"]}]}
});

/* ---------- CORE CALC ---------- */
function calculate(){
  const A_LIMIT = mode==="sip"?LIMITS.sip:LIMITS.lump;

  let A = clamp(num(amountInput.value),...A_LIMIT);
  let r = clamp(num(returnInput.value),...LIMITS.rate)/100;
  let y = clamp(num(yearInput.value),...LIMITS.years);

  amountInput.value=A;
  returnInput.value=(r*100).toFixed(1);
  yearInput.value=y;

  amountRange.value=A;
  returnRange.value=r*100;
  yearRange.value=y;

  const rm=r/12,months=y*12;
  let investedAmt=0,maturityAmt=0;

  if(mode==="sip"){
    let sip=A;
    for(let m=1;m<=months;m++){
      investedAmt+=sip;
      maturityAmt+=sip*Math.pow(1+rm,months-m);
      if(sipStepToggle.checked && m%sipStepInterval.value===0){
        sip+=sipStepType.value==="fixed"
          ? num(sipStepValue.value)
          : sip*(num(sipStepValue.value)/100);
      }
    }
  }else{
    investedAmt=A;
    maturityAmt=A*Math.pow(1+r,y);
  }

  invested.textContent=₹(investedAmt);
  returns.textContent=₹(maturityAmt-investedAmt);
  maturity.textContent=₹(maturityAmt);

  chart.data.datasets[0].data=[maturityAmt-investedAmt,investedAmt];
  chart.update();
}

/* ---------- EVENTS ---------- */
[sipStepToggle,sipStepType,sipStepValue,sipStepInterval,
 amountInput,returnInput,yearInput,
 amountRange,returnRange,yearRange]
.forEach(e=>e.addEventListener("input",calculate));

sipStepToggle.onchange=()=>sipAdvanced.style.display=sipStepToggle.checked?"block":"none";

/* ---------- INIT ---------- */
amountRange.min=LIMITS.sip[0];
amountRange.max=LIMITS.sip[1];
returnRange.min=LIMITS.rate[0];
returnRange.max=LIMITS.rate[1];
yearRange.min=LIMITS.years[0];
yearRange.max=LIMITS.years[1];

amountInput.value=10000;
returnInput.value=12;
yearInput.value=10;
sipStepValue.value=5000;

calculate();
</script>
</body>
</html>
