<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SIP & Lumpsum Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f6f7f9}
main{max-width:420px;margin:30px auto;padding:16px}
.card{background:#fff;border-radius:16px;padding:20px;box-shadow:0 8px 24px rgba(0,0,0,.08)}

.tabs{display:flex;background:#eef2f7;border-radius:30px;padding:4px;margin-bottom:20px}
.tab{flex:1;text-align:center;padding:10px;font-weight:bold;border-radius:30px;cursor:pointer}
.tab.active{background:#2563eb;color:#fff}

.field{margin-bottom:18px}
.label{display:flex;justify-content:space-between;font-weight:bold;margin-bottom:6px}
.box{background:#eafff6;padding:6px 10px;border-radius:6px;font-weight:bold}
.box input{border:none;background:transparent;width:90px;text-align:right;font-weight:bold;outline:none}

input[type=range]{width:100%}

.advanced{background:#f9fafb;border-radius:10px;padding:12px;margin-bottom:18px;display:none}

.results{margin-top:20px;font-weight:bold}
.results div{display:flex;justify-content:space-between;margin-bottom:8px}

.compare{background:#eef2f7;border-radius:10px;padding:12px;margin-top:18px;display:none;font-size:13px}
.compare table{width:100%;border-collapse:collapse}
.compare th,.compare td{padding:6px;text-align:right}
.compare th:first-child,.compare td:first-child{text-align:left}

canvas{max-width:220px;margin:20px auto 0;display:block}
</style>
</head>

<body>
<main>
<div class="card">

<div class="tabs">
  <div class="tab active" id="sipTab">SIP</div>
  <div class="tab" id="lumpTab">Lumpsum</div>
</div>

<!-- AMOUNT -->
<div class="field">
  <div class="label">
    <span id="amountLabel">Monthly Investment</span>
    <div class="box">₹ <input id="amountInput"></div>
  </div>
  <input type="range" id="amountRange" min="100" max="100000" step="100">
</div>

<!-- SIP ADVANCED -->
<div class="field" id="sipToggleWrap">
  <label><input type="checkbox" id="sipStepOn"> Increase SIP over time</label>
</div>

<div class="advanced" id="sipAdvanced">
  <div class="field">
    <label>Increase Type</label>
    <select id="sipType">
      <option value="fixed">Fixed (₹)</option>
      <option value="percent">Percentage (%)</option>
    </select>
  </div>

  <div class="field">
    <label>Increase Value</label>
    <input id="sipValue">
  </div>

  <div class="field">
    <label>Increase Interval</label>
    <select id="sipInterval">
      <option value="6">Every 6 Months</option>
      <option value="12">Every 1 Year</option>
    </select>
  </div>
</div>

<!-- RETURN -->
<div class="field">
  <div class="label">
    <span>Expected Return</span>
    <div class="box"><input id="rateInput"> %</div>
  </div>
  <input type="range" id="rateRange" min="1" max="40" step="0.1">
</div>

<!-- YEARS -->
<div class="field">
  <div class="label">
    <span>Time Period</span>
    <div class="box"><input id="yearInput"> Yr</div>
  </div>
  <input type="range" id="yearRange" min="1" max="50" step="1">
</div>

<div class="results">
  <div><span>Total Invested</span><span id="invested">₹0</span></div>
  <div><span>Estimated Returns</span><span id="returns">₹0</span></div>
  <div><span>Maturity Value</span><span id="maturity">₹0</span></div>
</div>

<div class="compare" id="compareBox">
<table>
<tr>
  <th></th>
  <th>Without Increase</th>
  <th>With Increase</th>
  <th>Difference</th>
</tr>
<tr>
  <td>Total Investment</td>
  <td id="cInvN"></td>
  <td id="cInvA"></td>
  <td id="cInvD"></td>
</tr>
<tr>
  <td>Estimated Returns</td>
  <td id="cRetN"></td>
  <td id="cRetA"></td>
  <td id="cRetD"></td>
</tr>
<tr>
  <td>Maturity Value</td>
  <td id="cMatN"></td>
  <td id="cMatA"></td>
  <td id="cMatD"></td>
</tr>
</table>
</div>

<canvas id="chart"></canvas>

</div>
</main>

<script>
/* ---------- HELPERS ---------- */
const INR=n=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(Math.round(n));
const num=v=>Math.max(0,Number(String(v).replace(/[^0-9.]/g,""))||0);
const clamp=(v,min,max)=>Math.min(Math.max(v,min),max);

/* ---------- STATE ---------- */
let mode="sip";

/* ---------- ELEMENTS ---------- */
const amountInput=document.getElementById("amountInput");
const amountRange=document.getElementById("amountRange");
const rateInput=document.getElementById("rateInput");
const rateRange=document.getElementById("rateRange");
const yearInput=document.getElementById("yearInput");
const yearRange=document.getElementById("yearRange");

const sipStepOn=document.getElementById("sipStepOn");
const sipAdvanced=document.getElementById("sipAdvanced");
const sipType=document.getElementById("sipType");
const sipValue=document.getElementById("sipValue");
const sipInterval=document.getElementById("sipInterval");

const investedEl=document.getElementById("invested");
const returnsEl=document.getElementById("returns");
const maturityEl=document.getElementById("maturity");

/* ---------- CHART ---------- */
const chart=new Chart(document.getElementById("chart"),{
  type:"doughnut",
  data:{labels:["Returns","Invested"],datasets:[{data:[0,0],backgroundColor:["#facc15","#2563eb"]}]},
  options:{plugins:{legend:{position:"bottom"}}}
});

/* ---------- EVENTS ---------- */
document.querySelectorAll("input,select").forEach(e=>e.addEventListener("input",calculate));
sipStepOn.onchange=()=>sipAdvanced.style.display=sipStepOn.checked?"block":"none";

/* ---------- CALC ---------- */
function calculate(){
  let A=clamp(num(amountInput.value),100,10000000);
  let r=clamp(num(rateInput.value),1,100)/100;
  let y=clamp(num(yearInput.value),1,100);

  amountInput.value=A;
  amountRange.value=Math.min(A,100000);
  rateInput.value=(r*100).toFixed(1);
  rateRange.value=Math.min(r*100,40);
  yearInput.value=y;
  yearRange.value=Math.min(y,50);

  let months=y*12, rm=r/12;

  let invN=0, matN=0;
  let invA=0, matA=0;

  let sip=A;

  for(let m=1;m<=months;m++){
    invN+=A;
    matN+=A*Math.pow(1+rm,months-m);

    invA+=sip;
    matA+=sip*Math.pow(1+rm,months-m);

    if(sipStepOn.checked && m%Number(sipInterval.value)===0){
      sip+=sipType.value==="percent"
        ? sip*clamp(num(sipValue.value),1,100)/100
        : clamp(num(sipValue.value),1,100000);
    }
  }

  investedEl.textContent=INR(invA);
  maturityEl.textContent=INR(matA);
  returnsEl.textContent=INR(matA-invA);

  chart.data.datasets[0].data=[matA-invA,invA];
  chart.update();

  if(sipStepOn.checked){
    compareBox.style.display="block";
    cInvN.textContent=INR(invN);
    cInvA.textContent=INR(invA);
    cInvD.textContent=INR(invA-invN);
    cRetN.textContent=INR(matN-invN);
    cRetA.textContent=INR(matA-invA);
    cRetD.textContent=INR((matA-invA)-(matN-invN));
    cMatN.textContent=INR(matN);
    cMatA.textContent=INR(matA);
    cMatD.textContent=INR(matA-matN);
  }else{
    compareBox.style.display="none";
  }
}

/* ---------- INIT ---------- */
amountInput.value=10000;
rateInput.value=12;
yearInput.value=10;
sipValue.value=1000;
calculate();
</script>

</body>
</html>
