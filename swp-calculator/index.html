<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SWP Calculator | CalcWorld</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:Arial, sans-serif;
  background:#f3f6fb;
  margin:0;
  padding:0;
}
header{
  background:#fff;
  padding:14px 24px;
  box-shadow:0 2px 6px rgba(0,0,0,0.06);
}
header a{
  font-size:20px;
  font-weight:bold;
  color:#2563eb;
  text-decoration:none;
}
.container{
  padding:20px;
}
.card{
  max-width:820px;
  margin:30px auto;
  background:#fff;
  padding:28px;
  border-radius:14px;
  box-shadow:0 15px 40px rgba(0,0,0,0.08);
}
h1{text-align:center;margin-bottom:25px}
.group{margin-bottom:22px}
label{font-weight:600;display:block;margin-bottom:6px}
input,select{width:100%;padding:10px;font-size:16px}
input[type=range]{margin-top:6px}
.results{
  margin-top:30px;
  background:#f8fafc;
  padding:20px;
  border-radius:10px;
}
.results p{margin:8px 0;font-size:16px}
.status{margin-top:15px;padding:12px;border-radius:8px;font-weight:600}
.safe{background:#dcfce7;color:#166534}
.danger{background:#fee2e2;color:#991b1b}
</style>
</head>

<body>

<header>
  <a href="https://calcworld.in/">CalcWorld</a>
</header>

<div class="container">
<div class="card">
<h1>SWP Calculator</h1>

<!-- Investment -->
<div class="group">
<label>Total Investment (₹)</label>
<input type="text" id="investment" value="10,00,000">
<input type="range" id="investmentRange" min="0" max="100000000" step="10000" value="1000000">
</div>

<!-- Return -->
<div class="group">
<label>Expected Annual Return (%)</label>
<input type="number" id="return" min="0" max="40" step="0.1" value="8">
<input type="range" id="returnRange" min="0" max="40" step="0.1" value="8">
</div>

<!-- Withdrawal -->
<div class="group">
<label>Withdrawal</label>
<select id="frequency">
  <option value="12">Monthly</option>
  <option value="4">Quarterly</option>
  <option value="1">Yearly</option>
</select>

<input type="text" id="withdrawal" value="10,000">
<input type="range" id="withdrawalRange" min="0" step="1000">
</div>

<!-- Time -->
<div class="group">
<label>Time Period (Years)</label>
<input type="number" id="years" min="1" max="60" value="20">
<input type="range" id="yearsRange" min="1" max="60" value="20">
</div>

<!-- Results -->
<div class="results">
<p><strong>Total Withdrawn:</strong> ₹ <span id="totalWithdrawn">0</span></p>
<p><strong>Remaining Corpus:</strong> ₹ <span id="remaining">0</span></p>
<p><strong>Corpus Sustains For:</strong> <span id="duration">0</span></p>
<div id="status" class="status"></div>
</div>
</div>
</div>

<script>
const inv = document.getElementById("investment");
const invR = document.getElementById("investmentRange");
const ret = document.getElementById("return");
const retR = document.getElementById("returnRange");
const wd = document.getElementById("withdrawal");
const wdR = document.getElementById("withdrawalRange");
const freq = document.getElementById("frequency");
const yrs = document.getElementById("years");
const yrsR = document.getElementById("yearsRange");

const parseINR = v => Number(v.replace(/,/g,'')) || 0;
const formatINR = n => Math.round(n).toLocaleString("en-IN");

invR.oninput = () => {
  inv.value = formatINR(invR.value);
  updateWithdrawalLimit();
  calculate();
};
inv.onblur = () => {
  let v = Math.min(parseINR(inv.value),100000000);
  invR.value = v;
  inv.value = formatINR(v);
  updateWithdrawalLimit();
  calculate();
};

retR.oninput = () => {
  ret.value = retR.value;
  calculate();
};
ret.onblur = () => {
  let v = Math.min(Math.max(Number(ret.value)||0,0),40);
  ret.value = v;
  retR.value = v;
  calculate();
};

yrsR.oninput = () => {
  yrs.value = yrsR.value;
  calculate();
};
yrs.onblur = () => {
  let v = Math.min(Math.max(Number(yrs.value)||1,1),60);
  yrs.value = v;
  yrsR.value = v;
  calculate();
};

wdR.oninput = () => {
  wd.value = formatINR(wdR.value);
  calculate();
};
wd.onblur = () => {
  let max = wdR.max;
  let v = Math.min(parseINR(wd.value),max);
  wdR.value = v;
  wd.value = formatINR(v);
  calculate();
};

freq.onchange = calculate;

function updateWithdrawalLimit(){
  let max = parseINR(inv.value) * 0.5;
  wdR.max = max;
}

function formatDuration(periods, freq){
  let months = freq===12 ? periods :
               freq===4  ? periods*3 :
               periods*12;
  let y = Math.floor(months/12);
  let m = months%12;
  return m>0 ? `${y} years ${m} months` : `${y} years`;
}

function calculate(){
  let principal = parseINR(inv.value);
  let withdraw = parseINR(wd.value);
  let annual = Number(ret.value)/100;
  let years = Number(yrs.value);
  let f = Number(freq.value);

  let rate = annual/f;
  let totalPeriods = years*f;

  let bal = principal;
  let totalW = 0;
  let done = 0;

  for(let i=1;i<=totalPeriods;i++){
    bal += bal*rate;
    bal -= withdraw;
    if(bal<=0){ done=i; break; }
    totalW += withdraw;
    done=i;
  }

  document.getElementById("totalWithdrawn").innerText = formatINR(totalW);
  document.getElementById("remaining").innerText = formatINR(Math.max(bal,0));
  document.getElementById("duration").innerText = formatDuration(done,f);

  const st = document.getElementById("status");
  if(bal<=0){
    st.className="status danger";
    st.innerText="⚠️ Withdrawal too high. Corpus exhausted early.";
  }else{
    st.className="status safe";
    st.innerText="✅ Sustainable SWP. Corpus lasts full duration.";
  }
}

updateWithdrawalLimit();
calculate();
</script>

</body>
</html>
