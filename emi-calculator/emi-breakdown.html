<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Monthly EMI Breakdown | CalcWorld</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="View month-wise EMI breakdown with interest, principal and remaining balance. Designed for running EMIs." />
  <link rel="canonical" href="https://calcworld.in/emi-calculator/breakdown.html" />

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f6f7fb;
      margin: 0;
      padding: 20px;
    }

    .card {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(0,0,0,.08);
    }

    h1 {
      margin-top: 0;
      text-align: center;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
      font-size: 14px;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      font-size: 14px;
    }

    button {
      margin-top: 10px;
      padding: 12px;
      font-size: 16px;
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background: #1e4fd8;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 25px;
      font-size: 14px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: right;
    }

    th {
      background: #f1f5f9;
    }

    th:first-child,
    td:first-child {
      text-align: left;
    }

    tr.current {
      background: #e0f2fe;
      font-weight: bold;
    }

    .note {
      margin-top: 15px;
      font-size: 13px;
      color: #555;
    }

    footer {
      margin-top: 25px;
      text-align: center;
      font-size: 13px;
    }
    .download-actions {
  display: none;
  margin: 12px 0;
}

.download-actions button {
  padding: 6px 12px;
  font-size: 13px;
  margin-right: 6px;
  border-radius: 6px;
  border: 1px solid #2563eb;
  background: white;
  color: #2563eb;
  cursor: pointer;
}

.download-actions button:hover {
  background: #2563eb;
  color: white;
}

  </style>
</head>

<body>

<div class="card">
  <h1>Monthly EMI Breakdown</h1>

  <div class="grid">
    <div>
      <label>Loan Amount (â‚¹)</label>
      <input type="text" id="loan" placeholder="e.g. 10,00,000" inputmode="numeric">

    </div>

    <div>
      <label>Interest Rate (% per year)</label>
      <input type="number" id="rate" placeholder="e.g. 10.4">
    </div>

    <div>
      <label>Total Loan Tenure</label>
      <div style="display:flex; gap:8px;">
        <input type="number" id="tenure" placeholder="e.g. 3">
        <select id="tenureType">
          <option value="years">Years</option>
          <option value="months">Months</option>
        </select>
      </div>
    </div>

    <div>
      <label>EMI Start Month</label>
      <input type="month" id="startMonth">
    </div>
  </div>

  <button onclick="generateBreakdown()">Generate Monthly Breakdown</button>

  <div id="downloadActions" class="download-actions">
  <button onclick="downloadCSV()">CSV</button>
  <button onclick="downloadExcel()">Excel</button>
  </div>





  <div id="table"></div>

  <div class="note">
    ðŸ’¡ Tip: Scroll to the highlighted row to see your current month and remaining balance.
  </div>

  <footer>
    <a href="/emi-calculator/">Back to EMI Calculator</a> |
    <a href="/privacy-policy.html">Privacy Policy</a> |
    <a href="/terms.html">Terms & Conditions</a>
  </footer>
</div>

<script>
function formatINR(num) {
  return new Intl.NumberFormat("en-IN").format(Math.round(num));
}
function formatIndianInput(value) {
  value = value.replace(/,/g, "").replace(/\D/g, "");
  if (!value) return "";

  let lastThree = value.slice(-3);
  let otherNumbers = value.slice(0, -3);

  if (otherNumbers !== "") {
    lastThree = "," + lastThree;
  }

  return (
    otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree
  );
}

document.getElementById("loan").addEventListener("input", function (e) {
  const raw = e.target.value.replace(/,/g, "");
  e.target.value = formatIndianInput(raw);
});

function generateBreakdown() {
  window.breakdownData = [];

  const P = Number(
  document.getElementById("loan").value.replace(/,/g, "")
);

  const annualRate = Number(document.getElementById("rate").value);
  const tenureValue = Number(document.getElementById("tenure").value);
  const tenureType = document.getElementById("tenureType").value;
  const start = document.getElementById("startMonth").value;

  if (!P || !annualRate || !tenureValue || !start) {
    document.getElementById("table").innerHTML = "Please fill all fields.";
    return;
  }

  const N = tenureType === "years" ? tenureValue * 12 : tenureValue;
  const R = annualRate / 12 / 100;

  const EMI = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);

  


  let balance = P;
  let currentDate = new Date(start + "-01");
  const today = new Date();

  let html = `
    <table>
      <tr>
        <th>Month</th>
        <th>EMI</th>
        <th>Interest</th>
        <th>Principal</th>
        <th>Balance</th>
      </tr>
  `;

  for (let i = 1; i <= N; i++) {
    const interest = balance * R;
    const principal = EMI - interest;
    balance -= principal;

    const label = currentDate.toLocaleString("en-IN", {
      month: "short",
      year: "numeric"
    });

    const isCurrent =
      currentDate.getMonth() === today.getMonth() &&
      currentDate.getFullYear() === today.getFullYear();

    breakdownData.push({
     month: label,
     emi: EMI,
     interest: interest,
     principal: principal,
     balance: Math.max(balance, 0)
    });


    html += `
      <tr class="${isCurrent ? 'current' : ''}">
        <td>${label}</td>
        <td>â‚¹${formatINR(EMI)}</td>
        <td>â‚¹${formatINR(interest)}</td>
        <td>â‚¹${formatINR(principal)}</td>
        <td>â‚¹${formatINR(Math.max(balance, 0))}</td>
      </tr>
    `;

    currentDate.setMonth(currentDate.getMonth() + 1);
  }

  html += "</table>";
  document.getElementById("table").innerHTML = html;
  // âœ… SHOW DOWNLOAD BUTTONS
  document.getElementById("downloadActions").style.display = "block";

}
function downloadCSV() {
  if (!window.breakdownData || !breakdownData.length) {
    alert("Please generate the breakdown first.");
    return;
  }

  let csv = "Month,EMI,Interest,Principal,Balance\n";

  breakdownData.forEach(row => {
    csv += `${row.month},${Math.round(row.emi)},${Math.round(row.interest)},${Math.round(row.principal)},${Math.round(row.balance)}\n`;
  });

  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "emi-breakdown.csv";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
function downloadExcel() {
  if (!window.breakdownData || !breakdownData.length) {
    alert("Please generate the breakdown first.");
    return;
  }

  let csv = "Month,EMI,Interest,Principal,Balance\n";

  breakdownData.forEach(row => {
    csv += `${row.month},${Math.round(row.emi)},${Math.round(row.interest)},${Math.round(row.principal)},${Math.round(row.balance)}\n`;
  });

  const blob = new Blob([csv], { type: "application/vnd.ms-excel" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "emi-breakdown.xlsx"; // ðŸ‘ˆ Excel filename
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

</script>

</body>
</html>
